<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Thank You | Jamaica We Rise</title>
  <style>
    /* --- all your original styling preserved --- */
    *{margin:0;padding:0;box-sizing:border-box;}
    :root{
      --jamaica-green:#1a5f3f;
      --jamaica-gold:#ffd700;
      --iascend-orange:#f4a349;
      --iascend-blue:#b8edee;
      --text-dark:#1f2937;
      --text-light:#6b7280;
      --bg-gray:#f9fafb;
    }
    body{
      font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;
      background:linear-gradient(135deg,var(--jamaica-green)0%,#0d3d2a50%,var(--iascend-orange)100%);
      min-height:100vh;padding:20px;display:flex;align-items:center;justify-content:center;
    }
    .container{max-width:700px;width:100%;}
    .thank-you-card{background:#fff;border-radius:16px;padding:50px 40px;box-shadow:0 20px 60px rgba(0,0,0,.3);text-align:center;animation:fadeInUp .6s ease-out;}
    .success-icon{width:80px;height:80px;margin:0 auto 20px;background:linear-gradient(135deg,var(--jamaica-green),#2d8659);border-radius:50%;display:flex;align-items:center;justify-content:center;animation:scaleIn .5s ease-out .3s both;}
    .success-icon svg{width:40px;height:40px;color:#fff;}
    h1{font-size:2.2em;font-weight:700;color:var(--text-dark);margin-bottom:15px;}
    .subtitle{font-size:1.1em;color:var(--text-light);margin-bottom:30px;line-height:1.6;}
    .donation-summary{background:var(--bg-gray);border-radius:12px;padding:25px;margin-bottom:30px;}
    .summary-row{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;}
    .summary-row:last-child{margin-bottom:0;padding-top:15px;border-top:2px solid #e5e7eb;font-weight:700;}
    .summary-label{color:var(--text-light);font-size:.95em;}
    .summary-value{color:var(--text-dark);font-weight:600;}
    .soulmark-box{background:linear-gradient(135deg,rgba(244,163,73,.1),rgba(184,237,238,.1));border:2px solid var(--iascend-orange);border-radius:12px;padding:20px;margin-bottom:30px;}
    .soulmark-label{font-size:.85em;font-weight:600;color:var(--iascend-orange);margin-bottom:10px;text-transform:uppercase;letter-spacing:.05em;}
    .soulmark-hash{font-family:'Courier New',monospace;font-size:.9em;color:var(--text-dark);background:#fff;padding:12px;border-radius:6px;word-break:break-all;}
    .cta-section{background:linear-gradient(135deg,var(--iascend-orange),#e58f39);color:#fff;border-radius:12px;padding:30px;margin-bottom:25px;}
    .cta-title{font-size:1.5em;font-weight:700;margin-bottom:10px;}
    .cta-text{font-size:1em;margin-bottom:20px;opacity:.95;}
    .cta-button{display:inline-block;background:#fff;color:var(--iascend-orange);padding:15px 40px;border-radius:8px;font-size:1.1em;font-weight:700;text-decoration:none;transition:.3s;}
    .cta-button:hover{transform:translateY(-2px);box-shadow:0 10px 30px rgba(0,0,0,.2);}
    .secondary-links{display:flex;gap:20px;justify-content:center;margin-top:25px;}
    .secondary-link{color:var(--text-light);text-decoration:none;font-size:.95em;transition:.3s;}
    .secondary-link:hover{color:var(--iascend-orange);}
    @keyframes fadeInUp{from{opacity:0;transform:translateY(20px);}to{opacity:1;transform:translateY(0);}}
    @keyframes scaleIn{from{transform:scale(0);}to{transform:scale(1);}}
    @media(max-width:640px){.thank-you-card{padding:35px 25px;}h1{font-size:1.8em;}.secondary-links{flex-direction:column;gap:10px;}}
  </style>
</head>
<body>
  <div class="container">
    <div class="thank-you-card">
      <div class="success-icon">
        <svg fill="currentColor" viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
      </div>
      <h1>Thank You for Your Generosity!</h1>
      <p class="subtitle">Your donation has been successfully processed and will make a real difference in helping Jamaica rebuild and recover.</p>

      <div class="donation-summary">
        <div class="summary-row"><span class="summary-label">Donor</span><span class="summary-value" id="donorName">Loading...</span></div>
        <div class="summary-row"><span class="summary-label">Email</span><span class="summary-value" id="donorEmail">Loading...</span></div>
        <div class="summary-row"><span class="summary-label">Donation Date</span><span class="summary-value" id="donationDate">Loading...</span></div>
        <div class="summary-row"><span class="summary-label">Amount</span><span class="summary-value" id="donationAmount">Loading...</span></div>
      </div>

      <div class="soulmark-box">
        <div class="soulmark-label">Your SoulMarkⓈ Verification Hash</div>
        <div class="soulmark-hash" id="soulMark">Loading...</div>
      </div>

      <div class="cta-section">
        <div class="cta-title">Claim Your Digital Identity</div>
        <div class="cta-text">Join the movement. Create your verified username@iascendai identity and be part of the future of human-centered digital verification.</div>
        <a id="registerLink" href="/iascendai-register.html" class="cta-button">Create Your Identity →</a>
      </div>

      <div class="secondary-links">
        <a href="/tracker.html" class="secondary-link">View Impact Dashboard</a>
        <a href="/iascendai-verify.html" class="secondary-link">Verify Your SoulMarkⓈ</a>
        <a href="/" class="secondary-link">Return to Home</a>
      </div>
    </div>
  </div>

  <script>
    const API_BASE = "https://jamaica-we-rise.onrender.com";

    async function loadDonationDetails() {
      const params = new URLSearchParams(window.location.search);
      let sessionId = params.get("session_id");

      if (!sessionId) {
        document.getElementById("soulMark").textContent = "❌ Missing session ID in URL.";
        return;
      }

      // normalize braces
      if (sessionId.startsWith("{") && sessionId.endsWith("}")) {
        sessionId = sessionId.slice(1, -1);
      }

      try {
        const res = await fetch(`${API_BASE}/verify-donation/${encodeURIComponent(sessionId)}`, { cache: "no-store" });
        const data = await res.json();
        if (!res.ok || data.error) throw new Error(data.error || "Verification failed");

        document.getElementById("donorName").textContent = data.name || "—";
        document.getElementById("donorEmail").textContent = data.email || "—";
        document.getElementById("donationDate").textContent = new Date(data.createdAt).toLocaleDateString();
        document.getElementById("donationAmount").textContent = `$${data.amount || 0}`;
        document.getElementById("soulMark").textContent = data.soulMark || "Unavailable";

        // link forward to registration
        const regLink = document.getElementById("registerLink");
        regLink.href = `/iascendai-register.html?email=${encodeURIComponent(data.email)}&soulmark=${encodeURIComponent(data.soulMark)}`;
      } catch (err) {
        console.error("Verification error:", err);
        document.getElementById("soulMark").textContent = "⚠️ Unable to verify donation. Please refresh in a few seconds.";
      }
    }

    loadDonationDetails();
  </script>
</body>
</html>
